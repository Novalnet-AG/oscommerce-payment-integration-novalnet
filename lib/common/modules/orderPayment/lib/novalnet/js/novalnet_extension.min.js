/**
 * This file is used for extensions(capture, cancel, refund) using AJAX
 *
 * @author      Novalnet
 * @copyright   Copyright (c) Novalnet
 * @license     https://www.novalnet.de/payment-plugins/kostenlos/lizenz
 *
 * Script: novalnet_extension.js
 *
 */
function void_capture_status(){if(""==$("#nn_trans_status").val())return alert($("#nn_select_status").val()),!1;var n="CONFIRM"==$("#nn_trans_status").val()?$("#nn_capture_text").val():$("#nn_cancel_text").val();return confirm(n)&&ajaxCall({action:"edit",trans_status:$("#nn_trans_status").val()}),!0}function refund_amount_validation(){if(""==$("#nn_refund_trans_amount").val()||0==$("#nn_refund_trans_amount").val()||isNaN($("#nn_refund_trans_amount").val()))return alert($("#nn_amount_invalid").val()),!1;if(confirm($("#nn_refund_amount").val())){var n=$("#nn_refund_reason").val()||"";ajaxCall({action:"refund",amount:$("#nn_refund_trans_amount").val(),refund_reason:n})}}function instalment_refund_amount_validation(n){var a=`#nn_instalment_refund_${n}`;if(""==$(a+" #nn_refund_trans_amount").val()||0==$(a+" #nn_refund_trans_amount").val()||isNaN($(a+" #nn_refund_trans_amount").val()))return alert($("#nn_amount_invalid").val()),!1;confirm($("#nn_refund_amount").val())&&ajaxCall({action:"refund",amount:$(a+" #nn_refund_trans_amount").val(),instalment_cycle:n,refund_tid:$("#nn_refund_tid").val()})}function zero_amount_validation(){if(""==$("#nn_book_amount").val()||0==$("#nn_book_amount").val()||isNaN($("#nn_book_amount").val()))return alert($("#nn_amount_invalid").val()),!1;confirm($("#nn_zero_amount_book_confirm").val())&&ajaxCall({action:"book_amount",amount:$("#nn_book_amount").val()})}function ajaxCall(n){n.order_id=$("#nn_order_id").val(),$.ajax({url:$("#dir").val()+"lib/common/modules/orderPayment/lib/novalnet/novalnet_extension.php",method:"POST",data:n,beforeSend:function(){$("#nn_loading").show()},success:function(n){var a=JSON.parse(n);$("#message_plce").addClass("SUCCESS"==a.result.status?"alert-success":"alert-danger"),$("#messagetext").text(a.result.status_text),$("#messagediv").css("display","block")},error:function(n,a,t){console.log("Error:",a,n.responseText)},complete:function(){$("#nn_loading").hide()}})}$("#nn_book_amount").add("#nn_refund_trans_amount").on("input",(function(){var n=$(this).val().replace(/[^0-9]/g,"");$(this).val(n)})),$("#btn_ok").click((function(){$("#messagediv").addClass("d-none"),window.location.reload()})),$("#instalment_cancel").click((function(){var n=JSON.parse($("#nn_instalment_status").val());$("#instalment_cancel_All").removeClass("d-none"),$("#instalment_cancel_remaining").removeClass("d-none"),$("#instalment_cancel").addClass("d-none"),n.includes("Refunded")&&$("#instalment_cancel_All").addClass("d-none"),["Refunded","Pending","Canceled"].some((a=>n.includes(a)))||$("#instalment_cancel_remaining").addClass("d-none")})),$("#instalment_cancel_remaining").click((function(){confirm($("#nn_cancel_remaining").val())&&ajaxCall({action:"remaining_cycles"})})),$("#instalment_cancel_All").click((function(){confirm($("#nn_cancel_all").val())&&ajaxCall({action:"all_cycles"})}));